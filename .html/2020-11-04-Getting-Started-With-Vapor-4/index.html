<!DOCTYPE html><html><head><meta charset="utf-8"/><meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport"/><title>Khan's Blog</title><link href="/resources/index.css" rel="stylesheet"/><link href="/resources/prism.css" rel="stylesheet"/></head><body><article><h2>What is Vapor?</h2><p><a href="https://vapor.codes/">Vapor</a> is a modern server-side swift framework. It's community built , with tons of support for databases, hosting and user management. It's built on my favorite language <strong>Swift</strong>, meaning it's easy to learn, and has type safety built in.</p><p>I'll be building a small time tracking API similar to <a href="https://toggl.com/">Toggl</a> over the course of a few posts, this is the first in this series.</p><h2>Get Started - Installation</h2><h4>Install Swift</h4><p>If you're running a Mac, and already have Xcode installed. Great, you can skip this step. If not, go to the <a href="https://apps.apple.com/us/app/xcode/id497799835?mt=12">App Store</a> and download it.</p><p>If you're running a Linux computer, you'll have to go over to the <a href="https://swift.org/download/#using-downloads">Swift Downloads</a> page, and follow the instructions there for your distribution.</p><h4>Install Vapor</h4><p>We're going to need the vapor toolbox to run any project we make.</p><p>To install it on mac, you'll need <a href="https://brew.sh/">homebrew</a> installed. Once installed, run <code>brew install vapor</code> and homebrew will install it all for you. Then when it's done, verify your installation by running <code>vapor -help</code>. You should see a list of available commands.</p><p>If you're on Linux, you'll have to build vapor from source. Just run these commands in a terminal.</p><pre><code class="language-shell">git clone https://github.com/vapor/toolbox.git
cd toolbox
git checkout &lt;desired version&gt;
make install
</code></pre><p>Then verify it's installed correctly by running <code>vapor -help</code>.</p><h2>Creating a project</h2><p>Now, we're going to set up our working directory. I'm going to build a time logging API, so I'll name my project TimeLog.</p><p>We'll just run <code>vapor new TimeLog</code> and follow the prompts given to you. You'll probably want to answer no to all the questions and get a bare-bones template to get started. For that, you can add a <code>-n</code> flag to the end of the prevous command like this <code>vapor new TimeLog -n</code>.</p><p>Sweet! Now you have an empty vapor project!</p><h2>Get a Database Running</h2><p>I'm going to be using the Postgres database, as it's the one I have the most experience with. Vapor <a href="https://github.com/vapor/sqlite-nio">supports</a> <a href="https://github.com/vapor/fluent-mongo-driver">tons</a> <a href="https://github.com/vapor/mysql-nio">of</a> <a href="https://github.com/vapor/postgres-nio">databases</a>. So you should be able to follow along with this tutorial no matter which one you choose.</p><p>If you don't have any databases installed, I'd recommend Postgres. <a href="https://gist.github.com/ibraheem4/ce5ccd3e4d7a65589ce84f2a3b7c23a3">This gist</a> helped me a lot when I first installed it.</p><p>Since I'm using Postgres, I've created a database named <code>time-table</code> and opened the database to the url <code>postgres://&lt;Admin-Name&gt;:@localhost:5432/time-table</code>. Since this isn't goint to be a public project quite yet, I left off giving the database a password. If you're planning on releasing this server to the world, <em>you need a password</em>.</p><p>Once you have the url of your database, make a <code>.env</code> file in the root directory of your project. Then, insert the url you just made like this <code>DB_URL=postgres://&lt;Admin-Name&gt;:@localhost:5432/time-table</code> on the first line. Then you're all set with your database.</p><h2>Finally, Swift</h2><h4>Dependencies</h4><p>Make an Xcode project by running <code>vapor xcode</code> in your project's directory.</p><p>For this series, I'm going to be using a few SPM packages. If you're following along, install them by opening the <code>Package.swift</code> and adding these three dependencies below <code>.product(name: "Vapor", package: "vapor"),</code>:</p><pre><code class="language-swift">.product(name: "Fluent", package: "fluent"),
.product(name: "FluentPostgresDriver", package: "fluent-postgres-driver"),
.product(name: "JWT", package: "jwt")
</code></pre><p>Then, below where it says <code>.package(url: "https://github.com/vapor/vapor.git", from: "4.0.0"),</code> add these lines.</p><pre><code class="language-swift">.package(url: "https://github.com/vapor/fluent.git", from: "4.0.0"),
.package(url: "https://github.com/vapor/fluent-postgres-driver.git", from: "2.0.0"),
.package(url: "https://github.com/vapor/jwt.git", from: "4.0.0-rc.1"),
</code></pre><p>This will install Fluent, Vapor's database framework, JWT, which we'll use for user authentication and the Fluent Postgres Driver so we can use our Postgres database.</p><h4>Connect the database</h4><p>In your <code>configure.swift</code> file under Sources &gt; App add the following extension to the top of the file.</p><pre><code class="language-swift">extension Application {
    static let databaseURL = URL(string: Environment.get("DB_URL")!)!
}
</code></pre><p>This uses the <code>.env</code> file we made earlier to get the database url. You can use <code>.env</code> files for other things like admin keys and passwords you don't want plain in your code for anyone to see.</p><p>Now lets use that url in the <code>configure(_ )</code> function add the following line to the top.</p><pre><code class="language-swift">try app.databases.use(.postgres(url: Application.databaseURL), as: .psql)
</code></pre><p>Right now, Xcode will throw an error, so import the required dependencies at the top of the file.</p><pre><code class="language-swift">import Fluent
import FluentPostgresDriver
import JWT
</code></pre><h2>Conclusion</h2><p>There we go! You now have an empty vapor project with an empty database and all the dependencies installed. I'll be making a part 2 soon for this series, when it's up it'll be linked right here!</p></article><footer><p>Copyright ©️ Khan Winter 2024</p><p>Built In Swift</p><p><a href="https://twitter.com/thecoolwinter" rel="me">Twitter</a> | <a href="https://threads.net/thecoolwinter" rel="me">Threads</a> | <a href>RSS</a></p></footer></body></html>