<!DOCTYPE html><html lang="en" data-theme="light"><head><meta content="utf-8" name="charset"></meta><meta content="width=device-width, initial-scale=1, maximum-scale=5" name="viewport"></meta><meta content="only light" name="color-scheme"></meta><title>Khan's Blog 路 The Search Engine Matrix</title><meta content="One way search engines like google rank page poplarity using matrices." name="description"></meta><meta content="all" name="robots"></meta><meta content="Khan Winter, Swift, macOS, JavaScript, iOS, web development, blog, SwiftUI" name="keywords"></meta><meta content="website" property="og:type"></meta><meta content="Khan's Blog" property="og:sitename"></meta><meta content="https://khanwinter.com/2021-02-02-The-Search-Engine-Matrix/" property="og:url"></meta><meta content="Khan's Blog 路 The Search Engine Matrix" property="og:title"></meta><meta content="One way search engines like google rank page poplarity using matrices." property="og:description"></meta><meta content="https://khanwinter.com/2021-02-02-The-Search-Engine-Matrix/" property="twitter:url"></meta><meta content="Khan's Blog 路 The Search Engine Matrix" property="twitter:title"></meta><meta content="One way search engines like google rank page poplarity using matrices." property="twitter:description"></meta><link href="https://khanwinter.com/2021-02-02-The-Search-Engine-Matrix/" rel="canonical"/><link href="https://bsky.app/profile/khanwinter.com" rel="me"/><link href="https://twitter.com/thecoolwinter" rel="me"/><link href="https://mastodon.social/@thecoolwinter" rel="me"/><link href="https://threads.net/thecoolwinter" rel="me"/><link href="https://www.linkedin.com/in/thecoolwinter/" rel="me"/><link href="/assets/index.css" rel="stylesheet"/><script src="/assets/index.js"></script><link href="/assets/prism.css" rel="stylesheet"/><link href="/assets/code-theme.css" rel="stylesheet"/><script defer src="/assets/prism.js"></script><link data-nav="true" href="/" rel="prefetch"/><link data-nav="true" href="/about" rel="prefetch"/><link data-nav="true" href="/2025-03-29-Cross-Compiling-Swift/" rel="prefetch"/><link data-nav="true" href="/2024-11-02-New-Blog/" rel="prefetch"/><link data-nav="true" href="/2024-11-01-Hide-Desktop-Shortcut/" rel="prefetch"/><link data-nav="true" href="/2021-08-07-Sort-List-Of-Objects/" rel="prefetch"/><link data-nav="true" href="/2021-05-08-Implementing-Sin/" rel="prefetch"/><link data-nav="true" href="/2021-03-17-How-Computers-Calculate-Sin/" rel="prefetch"/><link data-nav="true" href="/2021-02-02-The-Search-Engine-Matrix/" rel="prefetch"/><link data-nav="true" href="/2021-01-07-Save-Codable-Dates-In-Firestore/" rel="prefetch"/><link data-nav="true" href="/2020-05-5-Scripting-With-Swift/" rel="prefetch"/><link data-nav="true" href="/2020-02-24-Programatic-UI-In-UIKit-Without-Storyboards/" rel="prefetch"/><link data-nav="true" href="/2020-11-04-Getting-Started-With-Vapor-4/" rel="prefetch"/><link data-nav="true" href="/2019-12-17-Save-Array-Of-Any-Object-In-Realm/" rel="prefetch"/><link data-nav="true" href="/2020-05-11-Subclassing-Sprites-In-SpriteKit/" rel="prefetch"/><link data-nav="true" href="/2020-05-5-Using-Dependencies-In-Swift-Scripts/" rel="prefetch"/><link data-nav="true" href="/2020-02-21-Easy-Container-Controllers-in-Swift/" rel="prefetch"/><link data-nav="true" href="/2019-12-19-Firebase-Auth-State-Listeners-iOS/" rel="prefetch"/></head><body><nav><ul><li><a href="/index.html">Posts</a></li><li><button onclick="navRandom()">Random</button></li><li><a href="/about.html">About</a></li></ul></nav><div class="content"><article><div class="article-header"><p>Feb 3, 2021</p><h1>The Search Engine Matrix</h1><h3>One way search engines like google rank page poplarity using matrices.</h3><div class="avatar" href="/about.html"><a href="/about.html"><img alt="Avatar Image" height="24" src="/assets/avatar.webp" width="24"></img><span>Khan Winter</span></a>路<a href="https://bsky.app/profile/khanwinter.com" target="_blank"><svg aria-label="Bluesky" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 530" version="1.1"><path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"/></svg></a></div></div><link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" rel="stylesheet"></link><script crossorigin="anonymous" defer integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script><script crossorigin="anonymous" defer integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
        ],
        throwOnError : true
    });
});</script><h2 id="search-engines-rank-pages-based-on-how-likely-you-are-to-visit-them"><a href="#search-engines-rank-pages-based-on-how-likely-you-are-to-visit-them" class="header-link">Search engines rank pages based on how likely you are to visit them</a></h2><p>For a person, this might be a simple thing to understand. You would probably think the search engine should probably rank websites that are more popular higher on the list. However, computers don't understand popularity inherently. We have to convert a human problem, "How popular is this website" into a math problem. How does one do that?</p><p>The answer: <strong>Matrices</strong></p><h2 id="a-bit-of-a-primer"><a href="#a-bit-of-a-primer" class="header-link">A bit of a primer</a></h2><p>If you haven't taken Linear Algebra, there's a good chance you have never heard of matrices. So here's a brief explaination.</p><p><strong>Matrices</strong> hold numbers in a grid, sort of like a Sudoku board. Below is a matrix called the <em>Identity Matrix</em> You can think of it as the 1 of matrices.</p><span class="math-block">$$
I=\begin{pmatrix}1&0&0\\ 0&1&0\\ 0&0&1\end{pmatrix}
$$</span><p>You can use matrices like other numbers, adding, subtracting, multiplying, dividing etc. For instance if we multiply <em>I</em> by 2 we get</p><span class="math-block">$$
I\cdot 2=\begin{pmatrix}2&0&0\\ 0&2&0\\ 0&0&2\end{pmatrix}
$$</span><p>We can also put numbers in where we currently have 0 like below, as well as have different numbers of rows and columns.</p><span class="math-block">$$
I_2=\begin{pmatrix}1\\ 0\\ 0\end{pmatrix},\:I_3=\begin{pmatrix}1&\frac{1}{2}&\infty \\ sin\left(\theta \right)&\pi &\log \left(20\right)\\ -1&2&\frac{3}{4}\end{pmatrix}
$$</span><p>If you multiply a narrow matrix by a wider matrix with the same number of rows, you'll end up with a narrow matrix. This will come in handy later when calculating probabilities.</p><span class="math-block">$$
I_2\cdot I=\begin{pmatrix}1&0&0\\ 0&1&0\\ 0&0&1\end{pmatrix}\begin{pmatrix}1\\ 0\\ 0\end{pmatrix}=\begin{pmatrix}1\\ 0\\ 0\end{pmatrix}
$$</span><h2 id="turning-the-emhumanem-problem-into-a-emcomputerem-problem"><a href="#turning-the-emhumanem-problem-into-a-emcomputerem-problem" class="header-link">Turning the <em>human</em> problem into a <em>computer</em> problem</a></h2><p>Say, for instance, we have a group of 3 websites which are linked in a graph like this:</p><img src="1.png" alt="Website Graph"/><p>In this graph, website 1 links only to website 2, website 2 links to both 1 and 3, and website 3 links to both 1 and 2.</p><p>For each website we want to know how it links to the other websites <strong>mathematically</strong>. So, for website 2, we'll make a single-column matrix like this: <img src="2.png" alt="Single-column matrix"/></p><p>This matrix only has one column, which adds up to 1. We got the numbers for the matrix by adding up all the links that that website links to, and dividing one by that sum, eg: <span class="math-inline">$\frac{1}{Number\:Of\:Links}$</span>. We'll now create this matrix for each website, and combine them into one, larger matrix which we'll label <span class="math-inline">$A$</span>.</p><span class="math-block">$$
A=\:\begin{pmatrix}0&\frac{1}{2}&\frac{1}{2}\\ 1&0&\frac{1}{2}\\ 0&\frac{1}{2}&0\end{pmatrix}
$$</span><p>Each column in this matrix represents how one of the three websites links to the other two.</p><h2 id="follow-the-links"><a href="#follow-the-links" class="header-link">Follow the links</a></h2><p>Now that we have a matrix representing the website graph, we can start following it around to different websites. We'll start at website 3. We've got a 50/50 chance of going to either website 1 or website 2. I'll roll a dice and it landed on website 2, so we'll go there.</p><p>Now that we're at website two, we have a 50/50 chance of going to either website 3, or website 1. The dice picks website 1.</p><p>Website 1 is different, it only links to website 2. So I don't even have to roll a die, I can only go to website 2.</p><p>This is a lot of writing, so I'll convert this into a formula.</p><hr><p>We'll start our walk through the links at page one. This is step one, so we'll name this variable <span class="math-inline">$p_0$</span>. <span class="math-inline">$p_0$</span> is going to be a matrix representing the probability of us being on any page after we've taken 0 steps. We're starting at website 1, so we have a 100% probability in the next step of going to website 2, meaning the matrix looks like this.</p><span class="math-block">$$
p_0=\begin{pmatrix}0\\ 1\\ 0\end{pmatrix}
$$</span><p>If I multiply <span class="math-inline">$p_0$</span> by <span class="math-inline">$A$</span> (which we created earlier) we'll end up with the probability of being at any of the resulting websites after one step (<span class="math-inline">$p_1$</span>).</p><span class="math-block">$$
p_1=A\cdot \:p_0=\:\begin{pmatrix}0&\frac{1}{2}&\frac{1}{2}\\ 1&0&\frac{1}{2}\\ 0&\frac{1}{2}&0\end{pmatrix}\cdot \begin{pmatrix}1\\ 0\\ 0\end{pmatrix}=\begin{pmatrix}0\\ 1\\ 0\end{pmatrix}
$$</span><p>The resulting matrix tells us that we have a 100% probability of being at website 2 after one step. This makes sence, since website 1 only links to website 2.</p><p>To find the next step, we just multiply <span class="math-inline">$p_1$</span> by <span class="math-inline">$A$</span> to get <span class="math-inline">$p_2$</span>.</p><span class="math-block">$$
p_2=A\cdot \:p_1=A\cdot A\cdot p_0=A^2p_0=\:\begin{pmatrix}0&\frac{1}{2}&\frac{1}{2}\\ \:1&0&\frac{1}{2}\\ \:0&\frac{1}{2}&0\end{pmatrix}\cdot \begin{pmatrix}0\\ \:1\\ \:0\end{pmatrix}=\begin{pmatrix}\frac{1}{2}\\ 0\\ \frac{1}{2}\end{pmatrix}
$$</span><p>I'm starting to see a patern. For each step we take, we're really just adding one power to <span class="math-inline">$A$</span>. On step one, we found <span class="math-inline">$A^1*p_0$</span>, on step two we found <span class="math-inline">$A^2*p_0$</span>, and so on. Because of that, we can say the following formula is true.</p><span class="math-block">$$
p_n=Ap_n=A^np_0
$$</span><p><strong>If we take a larger number of steps, we'll find the probability of being at any website in the graph.</strong></p><p>What if we find <span class="math-inline">$p_{15}$</span>? <em>(by the way I'm using <a href="https://www.symbolab.com/solver/matrix-calculator">symbolab</a> for these smaller computations)</em></p><span class="math-block">$$
p_{15}=\:\begin{pmatrix}0&\frac{1}{2}&\frac{1}{2}\\ 1&0&\frac{1}{2}\\ 0&\frac{1}{2}&0\end{pmatrix}^{15}\begin{pmatrix}1\\ 0\\ 0\end{pmatrix}=\begin{pmatrix}0.333313\\ 0.444763\\ 0.221924\end{pmatrix}
$$</span><p>This means after 15 steps through each website, <strong>we've got the highest probability of landing on website 2, then website 1, then website 3.</strong></p><p><strong>Congrats! You've found how likely a user is to navigate to each of these three sites!</strong></p><h2 id="this-seems-really-workintensive"><a href="#this-seems-really-workintensive" class="header-link">This seems really work-intensive</a></h2><p>It is tough to calculate <span class="math-inline">$p$</span> for each step, what if we had a <strong>huge</strong> graph of websites. We wouldn't know if we needed to stop walking the graph at 15 steps or 500! So how can we solve this problem?</p><hr><p><em>Side note: I'm going to redefine <span class="math-inline">$A$</span> from now on, so we're working with 5 websites.</em></p><span class="math-block">$$
A=\begin{pmatrix}0&\frac{1}{3}&\frac{1}{2}&\frac{1}{2}&0\\ \frac{1}{2}&0&0&0&0\\ 0&\frac{1}{3}&0&0&0\\ 0&\frac{1}{3}&\frac{1}{2}&0&1\\ \frac{1}{2}&0&0&\frac{1}{2}&0\end{pmatrix}
$$</span><hr><p>For starters lets define the actual formula we're working with here (<span class="math-inline">$n$</span> is the number of steps we take).</p><span class="math-block">$$
p_{n+1}=Ap_n
$$</span><p>If we take <span class="math-inline">$\infty$</span> steps, this equation becomes</p><span class="math-block">$$
p_\infty =Ap_\infty
$$</span><p>Which is equal to a proof meaning that <span class="math-inline">$p$</span> is actually something called an <em>eigenvector</em> which corrensponds to <span class="math-inline">$A$</span> and an <em>eigenvalue</em> of 1 since <span class="math-inline">$p_n$</span> will always add up to 1. (<a href="https://www.khanacademy.org/math/linear-algebra/alternate-bases/eigen-everything/v/linear-algebra-introduction-to-eigenvalues-and-eigenvectors">More about eigenvectors and eigenvalues</a>)</p><p>Using this proof we can use the calculation below to find an eigenvector of <span class="math-inline">$A$</span> which I'm going to call <span class="math-inline">$R$</span>. <span class="math-inline">$I$</span> is the identity matrix. <em>(now I'm using Matlab for these calculations since it's easier to work with matrices, I'll include the code at the bottom of this page)</em></p><span class="math-block">$$
I=\begin{pmatrix}1&0&0&0&0\\ \:\:0&1&0&0&0\\ \:\:0&0&1&0&0\\ \:\:0&0&0&1&0\\ \:\:0&0&0&0&1\end{pmatrix},\:R=rref\left(A-I\right)
$$</span><p>After this computation, <span class="math-inline">$R$</span> equals</p><span class="math-block">$$
R=\begin{pmatrix}1&0&0&0&-0.8\\ 0&1&0&0&-0.4\\ 0&0&1&0&-1.33\\ 0&0&0&1&-1.2\\ 0&0&0&0&0\end{pmatrix}
$$</span><p>From which we can draw the eigenvector <span class="math-inline">$v$</span> and the probability matrix <span class="math-inline">$p$</span>. <em>The first equation takes only the left column of <span class="math-inline">$R$</span> and then sets the 5th value to 1. Since <span class="math-inline">$p$</span> is a probability matrix, it always needs to add up to 1, so we divide it by it's sum to reduce it down to 1.</em></p><span class="math-block">$$
v=-R\left(:,5\right),\:v\left(5\right)=1
$$</span><span class="math-block">$$
p=\frac{v}{sum\left(v\right)}
$$</span><p>At this point, <span class="math-inline">$p$</span> equals</p><span class="math-block">$$
p=\begin{pmatrix}0.2264\\ 0.1132\\ 0.0377\\ 0.3396\\ 0.2830\end{pmatrix}
$$</span><p>Which is the final probability matrix.</p><h2 id="conclusion"><a href="#conclusion" class="header-link">Conclusion</a></h2><p>Using some fun math we're able to turn a human problem (<em>what's the most popular page</em>) into a computer problem (<em>what's the probability of reaching any page</em>). This is the job of computer scientists, to be able to break down problems in our world into their mathematical components, and tell a computer how to solve them.</p><p>KhanAcademy has some great resources on Matrices, Eigenvectors and Eigenvalues if you'd like to learn more here -&gt; <a href="https://www.khanacademy.org/math/linear-algebra">https://www.khanacademy.org/math/linear-algebra</a></p><p><em>If you have access to Matlab, and want to check my work or mess around on your own, here's the Matlab code I used for the second example.</em></p><pre><code class="language-matlab">&gt;&gt; A = [0 1/3 1/2 1/2 0; 1/2 0 0 0 0; 0 1/3 0 0 0; 0 1/3 1/2 0 1; 1/2 0 0 1/2 0];
&gt;&gt; I = eye(5); R = rref(A-I);
&gt;&gt; v=-R(:,5); v(5)=1; p=v/sum(v);
&gt;&gt; p

p =

    0.2264
    0.1132
    0.0377
    0.3396
    0.2830

</code></pre><hr></hr><div class="article-footer"><p>Feb 3, 2021</p><div class="avatar" href="/about.html"><a href="/about.html"><img alt="Avatar Image" height="24" src="/assets/avatar.webp" width="24"></img><span>Khan Winter</span></a>路<a href="https://bsky.app/profile/khanwinter.com" target="_blank"><svg aria-label="Bluesky" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 530" version="1.1"><path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"/></svg></a></div></div></article></div><footer><p>Copyright &copy Khan Winter 2025</p><p><a href="https://github.com/thecoolwinter/blog">Built In Swift</a></p><p><a href="https://bsky.app/profile/khanwinter.com" rel="me" target="_blank">Bluesky</a> | <a href>RSS</a></p></footer></body></html>